(()=>{(function(){"use strict";var _=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("k-view",{staticClass:"k-mailjet-sms-view"},[a("k-header",[e._v("Mailjet SMS")]),a("k-fieldset",{attrs:{fields:{to:{label:this.$t("mailjet.sms.to"),type:"text",placeholder:this.$t("mailjet.sms.to.placeholder"),width:"1/2",required:!0},from:{label:this.$t("mailjet.sms.from"),type:"text",placeholder:this.$t("mailjet.sms.from.placeholder"),width:"1/2"},message:{label:this.$t("mailjet.sms.message"),maxlength:e.message.maxlength,required:!0,type:"textarea",buttons:!1}}},model:{value:e.sms,callback:function(i){e.sms=i},expression:"sms"}}),a("div",{staticClass:"buttonwrapper"},[a("k-button",{staticClass:"smsbutton",class:{sending:e.sending,"has-error":e.hasError,"is-success":e.isSuccess},attrs:{icon:e.currenticon,disabled:!e.cansend},on:{click:function(i){return e.onClick()}}},[e._v(e._s(this.$t("mailjet.sms.action")))])],1)],1)},v=[],y="";function l(e,t,a,i,r,u,d,H){var s=typeof e=="function"?e.options:e;t&&(s.render=t,s.staticRenderFns=a,s._compiled=!0),i&&(s.functional=!0),u&&(s._scopeId="data-v-"+u);var o;if(d?(o=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(n=__VUE_SSR_CONTEXT__),r&&r.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(d)},s._ssrRegister=o):r&&(o=H?function(){r.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:r),o)if(s.functional){s._injectStyles=o;var M=s.render;s.render=function(x,f){return o.call(f),M(x,f)}}else{var m=s.beforeCreate;s.beforeCreate=m?[].concat(m,o):[o]}return{exports:e,options:s}}const g={data:function(){return{sms:{from:"",to:"",message:""},message:{maxlength:0},cooldown:Number,sending:!1,hasError:!1,isSuccess:!1}},created(){this.$api.get("mailjet/sms/config").then(e=>{this.sms.from=e.from,this.message.maxlength=e.maxlength,this.cooldown=e.cooldown}).catch(e=>{console.log(e)})},computed:{currenticon:function(){return this.hasError?"alert":this.isSuccess?"check":"mailjet-sms"},cansend:function(){return this.sms.to.length>0&&this.sms.message.length>0&&this.sms.message.length<=this.message.maxlength}},methods:{onClick:function(){this.sending=!0,this.$api.post("mailjet/sms/send",this.sms).then(e=>{e.statusCode===200?(this.handleSuccess(),this.sms.to=""):this.handleError(),this.sending=!1}).catch(e=>{this.sending=!1,console.log(e)})},handleSuccess:function(){let e=this;e.isSuccess=!0,setTimeout(function(){e.isSuccess=!1},e.cooldown)},handleError:function(){let e=this;e.hasError=!0,setTimeout(function(){e.hasError=!1},e.cooldown)}}},c={};var p=l(g,_,v,!1,w,"5bbfb5b9",null,null);function w(e){for(let t in c)this[t]=c[t]}var $=function(){return p.exports}(),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("k-view",{staticClass:"k-mailjet-schedule-view"},[a("k-header",[e._v("Mailjet Schedule")]),a("k-cards",{attrs:{"data-size":"small"}},e._l(e.schedules,function(i){return a("k-card",{key:i.value,attrs:{info:i.date,text:i.name}})}),1)],1)},V=[],E="";const j={name:"ScheduleView",data(){return{schedules:[]}},created(){this.load()},methods:{load(){this.$api.get("mailjet/schedule/list").then(e=>{this.schedules=e}).catch(e=>{console.log(e)})}}},h={};var b=l(j,S,V,!1,k,"182eaded",null,null);function k(e){for(let t in h)this[t]=h[t]}var C=function(){return b.exports}();panel.plugin("schnitzerund/sms",{views:{schedule:{component:C,icon:"mailjet-schedule",label:"Mailjet Schedule"},sms:{component:$,icon:"mailjet-sms",label:"Mailjet SMS"}},icons:{"mailjet-schedule":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g class="nc-icon-wrapper"><path data-color="color-2" d="M25,18a7,7,0,1,0,7,7A7,7,0,0,0,25,18Zm4,8H24V21h2v3h3Z"/> <path d="M16,29H4a1,1,0,0,1-1-1V10A1,1,0,0,1,4,9H28a1,1,0,0,1,1,1v6h2V6a2,2,0,0,0-2-2H24V1a1,1,0,0,0-2,0V4H10V1A1,1,0,0,0,8,1V4H3A2,2,0,0,0,1,6V29a2,2,0,0,0,2,2H16Z"/></g></svg>',"mailjet-sms":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><g class="nc-icon-wrapper"><path d="M43,1H23a4,4,0,0,0-4,4V25a1,1,0,0,0,1,1,.988.988,0,0,0,.581-.187L27.32,21H43a4,4,0,0,0,4-4V5A4,4,0,0,0,43,1ZM32,15H26a1,1,0,0,1,0-2h6a1,1,0,0,1,0,2Zm8-6H26a1,1,0,0,1,0-2H40a1,1,0,0,1,0,2Z" data-color="color-2"/><path d="M31,23V39a1,1,0,0,1-1,1H7a1,1,0,0,1-1-1V11a1,1,0,0,1,1-1H17V5H8A4,4,0,0,0,4,9V43a4,4,0,0,0,4,4H29a4,4,0,0,0,4-4V23Z"/></g></svg>'}})})();})();
